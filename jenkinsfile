pipeline {
	agent any
	    //def rtMaven = Artifactory.newMavenBuild()
//定义mvn环境
    

	stages {
		stage('Pre-') {
			steps {
			
				//sh "docker rm -f `docker ps -aqf ancestor=springboot-demo`"
				//sh "docker rmi springboot-demo"
				echo 'Pre...'
			}
		}
	    stage('Test') {
			steps {
			
			
				sh "/var/jenkins_home/apache-maven-3.6.0/bin/mvn test"
				
				echo 'Testing...'
			}
		}
		stage('Package'){
			steps {
				echo 'Packaging...'
				sh "/var/jenkins_home/apache-maven-3.6.0/bin/mvn clean package -DskipTests"
			}
		}
		stage('Docker-build') {
			steps {
				echo 'Testing...'
				sh "docker build -t springboot-demo ./"
			}
		}
		stage('Deploy') {
			steps {
			    //sh "docker run -d springboot-demo -p 8000:8000"
				echo 'Deploying...'
			}
		}
	
	}
}